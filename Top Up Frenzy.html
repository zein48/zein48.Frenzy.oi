<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta content="width=device-width, initial-scale=1" name="viewport" />
  <title>Top Up Frenzy - Top Up Menu</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <link
    href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/all.min.css"
    rel="stylesheet"
  />
  <style>
    /* Custom scrollbar for the page */
    ::-webkit-scrollbar {
      width: 8px;
    }
    ::-webkit-scrollbar-thumb {
      background-color: #4b5563;
      border-radius: 4px;
    }
    ::-webkit-scrollbar-track {
      background-color: #1f2937;
    }
  </style>
</head>
<body class="bg-gray-800 text-gray-300 font-sans min-h-screen">
  <!-- Navbar -->
  <nav
    class="bg-gray-900 flex items-center justify-between px-4 py-2 text-sm select-none"
  >
    <div class="flex items-center space-x-4">
      <a class="flex items-center" href="#">
        <img
          alt="TopUP logo, circular red background with white text TopUP"
          class="h-10 w-10 rounded-full"
          height="40"
          src="https://storage.googleapis.com/a1aa/image/74bf624a-c053-443f-44e9-3566a831cde6.jpg"
          width="40"
        />
        <span class="ml-2 text-white font-bold text-lg">Top Up Frenzy</span>
      </a>
    </div>
    <ul class="flex items-center space-x-4 text-gray-400">
      <li
        class="flex items-center space-x-1 hover:text-gray-200 cursor-pointer"
        id="nav-home"
      >
        <i class="fas fa-home"></i>
        <span>Home</span>
      </li>
      <li
        class="flex items-center space-x-1 hover:text-gray-200 cursor-pointer"
        id="nav-topup"
      >
        <i class="fas fa-gamepad"></i>
        <span>Top Up</span>
      </li>
      <li
        class="flex items-center space-x-1 hover:text-gray-200 cursor-pointer"
        id="nav-pricing"
      >
        <i class="fas fa-tags"></i>
        <span>Daftar Harga</span>
      </li>
      <li
        class="flex items-center space-x-1 hover:text-gray-200 cursor-pointer"
        id="nav-contact"
      >
        <i class="fas fa-envelope"></i>
        <span>Contact Us</span>
      </li>
      <li
        class="flex items-center space-x-1 hover:text-white cursor-pointer font-bold"
        id="nav-account"
      >
        <i class="fas fa-user-circle"></i>
        <span>Akun Saya</span>
      </li>
    </ul>
  </nav>
  <!-- Main Content -->
  <main class="max-w-7xl mx-auto p-6">
    <!-- Home Section -->
    <section class="hidden" id="section-home">
      <h1 class="text-3xl font-bold mb-4 text-white">
        Selamat Datang di Top Up Frenzy
      </h1>
      <p class="mb-6 text-gray-300">
        Pilih menu Top Up untuk mulai melakukan pembelian diamond atau item game
        favorit Anda.
      </p>
    </section>
    <!-- Top Up Section -->
    <section class="hidden" id="section-topup">
      <h2 class="text-2xl font-semibold mb-4 text-white">
        Pilih Game dan Paket Top Up
      </h2>
      <div
        class="grid grid-cols-2 sm:grid-cols-3 md:grid-cols-5 lg:grid-cols-6 gap-6 mb-8"
        id="gamesGrid"
      >
        <!-- Game Cards -->
      </div>
    </section>
    <!-- Package Selection Section -->
    <section
      class="hidden max-w-3xl mx-auto bg-gray-900 rounded-md p-6 mt-6"
      id="packageSection"
    >
      <h3 class="text-xl font-semibold mb-4 text-white" id="selectedGameTitle">
        Pilih Paket Top Up
      </h3>
      <div class="grid grid-cols-1 sm:grid-cols-2 gap-4" id="packagesGrid">
        <!-- Packages will be dynamically inserted here -->
      </div>
      <div class="mt-6 text-center">
        <button
          class="bg-blue-600 hover:bg-blue-700 text-white font-semibold py-2 px-6 rounded-md"
          onclick="showPaymentMethods()"
        >
          Lanjut ke Metode Pembayaran
        </button>
      </div>
    </section>
    <!-- Payment Methods Section -->
    <section
      class="hidden max-w-3xl mx-auto bg-gray-900 rounded-md p-6 mt-6"
      id="paymentMethodsSection"
    >
      <h3 class="text-xl font-semibold mb-4 text-white">
        Pilih Metode Pembayaran
      </h3>
      <div class="grid grid-cols-1 sm:grid-cols-2 gap-4">
        <button
          class="bg-green-600 hover:bg-green-700 text-white font-semibold py-3 rounded-md flex items-center justify-center space-x-3"
          onclick="contactAdmin('WhatsApp')"
        >
          <i class="fab fa-whatsapp fa-lg"></i>
          <span>WhatsApp</span>
        </button>
        <button
          class="bg-blue-600 hover:bg-blue-700 text-white font-semibold py-3 rounded-md flex items-center justify-center space-x-3"
          onclick="contactAdmin('Transfer Bank')"
        >
          <i class="fas fa-university fa-lg"></i>
          <span>Transfer Bank</span>
        </button>
        <button
          class="bg-yellow-500 hover:bg-yellow-600 text-gray-900 font-semibold py-3 rounded-md flex items-center justify-center space-x-3"
          onclick="contactAdmin('OVO')"
        >
          <i class="fas fa-mobile-alt fa-lg"></i>
          <span>OVO</span>
        </button>
        <button
          class="bg-purple-600 hover:bg-purple-700 text-white font-semibold py-3 rounded-md flex items-center justify-center space-x-3"
          onclick="contactAdmin('DANA')"
        >
          <i class="fas fa-wallet fa-lg"></i>
          <span>DANA</span>
        </button>
      </div>
      <div class="mt-6 text-center">
        <button
          class="bg-gray-700 hover:bg-gray-800 text-white font-semibold py-2 px-6 rounded-md"
          onclick="backToPackages()"
        >
          Kembali ke Pilihan Paket
        </button>
      </div>
    </section>
    <!-- Payment Instructions Section -->
    <section
      class="hidden max-w-3xl mx-auto bg-yellow-400 text-gray-900 rounded-md p-6 mt-6"
      id="paymentSection"
    >
      <h3 class="text-xl font-semibold mb-4">Instruksi Pembayaran</h3>
      <p class="mb-4" id="paymentMethodInfo">
        Silakan lakukan pembayaran melalui WhatsApp Admin terlebih dahulu.
        Setelah pembayaran dikonfirmasi, proses top up akan segera dilakukan.
      </p>
      <p class="mb-4 font-bold">
        WhatsApp Admin:
        <a
          class="underline text-blue-700"
          href="https://wa.me/6285270892831"
          rel="noopener noreferrer"
          target="_blank"
          id="whatsappLink"
          >085270892831</a
        >
      </p>
      <p class="mb-4 font-bold">
        Instagram Admin:
        <a
          class="underline text-blue-700"
          href="https://instagram.com/hafizputrazeinn.48"
          rel="noopener noreferrer"
          target="_blank"
          >@hafizputrazeinn.48</a
        >
      </p>
      <p>
        Mohon kirimkan bukti pembayaran dan detail top up Anda melalui WhatsApp.
      </p>
      <div class="mt-6 text-center">
        <button
          class="bg-gray-700 hover:bg-gray-800 text-white font-semibold py-2 px-6 rounded-md"
          onclick="resetTopUp()"
        >
          Kembali ke Pilihan Game
        </button>
      </div>
    </section>
    <!-- Daftar Harga Section -->
    <section class="hidden" id="section-pricing">
      <h2 class="text-2xl font-semibold mb-4 text-white">Daftar Harga</h2>
      <div
        class="overflow-x-auto bg-gray-900 rounded-md p-4 max-h-[400px] overflow-y-auto"
      >
        <table class="min-w-full text-left text-gray-300">
          <thead>
            <tr class="border-b border-gray-700">
              <th class="py-2 px-3">Game</th>
              <th class="py-2 px-3">Item</th>
              <th class="py-2 px-3">Harga (IDR)</th>
            </tr>
          </thead>
          <tbody id="priceTableBody"></tbody>
        </table>
      </div>
    </section>
    <!-- Contact Us Section -->
    <section class="hidden" id="section-contact">
      <h2 class="text-2xl font-semibold mb-4 text-white">Contact Us</h2>
      <p class="mb-4 text-gray-300">
        Untuk pertanyaan dan dukungan, silakan hubungi Admin melalui email
        berikut:
      </p>
      <a class="text-blue-400 underline" href="mailto:zeinhafizputra@gmail.com"
        >zeinhafizputra@gmail.com</a
      >
    </section>
    <!-- Account Section -->
    <section
      class="hidden max-w-md mx-auto mt-8 bg-gray-900 rounded-md p-6"
      id="section-account"
    >
      <h2 class="text-2xl font-semibold mb-4 text-white text-center">
        Akun Pembeli
      </h2>
      <div
        id="userInfo"
        class="hidden flex items-center space-x-4 bg-gray-800 rounded-md p-4 mb-6"
      >
        <img
          alt="User profile picture"
          class="w-16 h-16 rounded-full"
          id="userAvatar"
          src=""
        />
        <div>
          <p class="text-white font-semibold" id="userName"></p>
          <button class="text-red-500 underline text-sm mt-1" onclick="logoutUser()">
            Logout
          </button>
        </div>
      </div>
      <form class="space-y-4" id="loginForm" onsubmit="return loginUser(event)">
        <div>
          <label class="block mb-1" for="loginEmail">Email</label>
          <input
            class="w-full rounded-md px-3 py-2 text-gray-900 focus:outline-none focus:ring-2 focus:ring-blue-600"
            id="loginEmail"
            placeholder="Masukkan email"
            required
            type="email"
          />
        </div>
        <div>
          <label class="block mb-1" for="loginPassword">Password</label>
          <input
            class="w-full rounded-md px-3 py-2 text-gray-900 focus:outline-none focus:ring-2 focus:ring-blue-600"
            id="loginPassword"
            placeholder="Masukkan password"
            required
            type="password"
          />
        </div>
        <button
          class="w-full bg-blue-600 hover:bg-blue-700 text-white font-semibold py-2 rounded-md"
          type="submit"
        >
          Login
        </button>
      </form>
      <p class="mt-4 text-center text-gray-400">
        Belum punya akun?
        <button class="text-blue-400 underline" onclick="showRegister()">
          Daftar di sini
        </button>
      </p>
      <form
        class="space-y-4 mt-6 hidden"
        id="registerForm"
        onsubmit="return registerUser(event)"
      >
        <div>
          <label class="block mb-1" for="registerEmail">Email</label>
          <input
            class="w-full rounded-md px-3 py-2 text-gray-900 focus:outline-none focus:ring-2 focus:ring-blue-600"
            id="registerEmail"
            placeholder="Masukkan email"
            type="email"
          />
        </div>
        <div>
          <label class="block mb-1" for="registerPassword">Password</label>
          <input
            class="w-full rounded-md px-3 py-2 text-gray-900 focus:outline-none focus:ring-2 focus:ring-blue-600"
            id="registerPassword"
            placeholder="Masukkan password"
            type="password"
          />
        </div>
        <button
          class="w-full bg-green-600 hover:bg-green-700 text-white font-semibold py-2 rounded-md"
          type="submit"
        >
          Daftar
        </button>
        <p class="mt-4 text-center text-green-400 hidden" id="registerSuccess">
          Pendaftaran berhasil! Silakan login menggunakan email dan password Anda.
        </p>
      </form>
    </section>
  </main>
  <!-- Floating Social Buttons -->
  <div
    class="fixed right-4 bottom-24 flex flex-col space-y-3 z-50"
  >
    <a
      aria-label="Instagram Admin"
      class="w-12 h-12 rounded-xl bg-gradient-to-b from-pink-500 via-red-500 to-yellow-400 flex items-center justify-center text-white shadow-lg hover:opacity-90"
      href="https://instagram.com/hafizputrazeinn.48"
      rel="noopener noreferrer"
      target="_blank"
      ><i class="fab fa-instagram fa-lg"></i
    ></a>
    <a
      aria-label="WhatsApp Admin"
      class="w-12 h-12 rounded-xl bg-green-500 flex items-center justify-center text-white shadow-lg hover:opacity-90"
      href="https://wa.me/6285270892831"
      rel="noopener noreferrer"
      target="_blank"
      ><i class="fab fa-whatsapp fa-lg"></i
    ></a>
    <a
      aria-label="Discord Chat"
      class="w-12 h-12 rounded-xl bg-blue-700 flex items-center justify-center text-white shadow-lg hover:opacity-90"
      href="#"
      ><i class="fab fa-discord fa-lg"></i
    ></a>
  </div>
  <script>
    // Navigation and section toggling
    const navHome = document.getElementById("nav-home");
    const navTopUp = document.getElementById("nav-topup");
    const navPricing = document.getElementById("nav-pricing");
    const navContact = document.getElementById("nav-contact");
    const navAccount = document.getElementById("nav-account");

    const sectionHome = document.getElementById("section-home");
    const sectionTopUp = document.getElementById("section-topup");
    const sectionPricing = document.getElementById("section-pricing");
    const sectionContact = document.getElementById("section-contact");
    const sectionAccount = document.getElementById("section-account");

    function hideAllSections() {
      sectionHome.classList.add("hidden");
      sectionTopUp.classList.add("hidden");
      sectionPricing.classList.add("hidden");
      sectionContact.classList.add("hidden");
      sectionAccount.classList.add("hidden");
    }

    function setActiveNav(activeNav) {
      [navHome, navTopUp, navPricing, navContact, navAccount].forEach((nav) => {
        nav.classList.remove("font-bold", "text-white");
        nav.classList.add("text-gray-400");
      });
      activeNav.classList.add("font-bold", "text-white");
      activeNav.classList.remove("text-gray-400");
    }

    navHome.addEventListener("click", () => {
      hideAllSections();
      sectionHome.classList.remove("hidden");
      setActiveNav(navHome);
    });
    navTopUp.addEventListener("click", () => {
      hideAllSections();
      sectionTopUp.classList.remove("hidden");
      resetTopUp();
      setActiveNav(navTopUp);
    });
    navPricing.addEventListener("click", () => {
      hideAllSections();
      sectionPricing.classList.remove("hidden");
      setActiveNav(navPricing);
    });
    navContact.addEventListener("click", () => {
      hideAllSections();
      sectionContact.classList.remove("hidden");
      setActiveNav(navContact);
    });
    navAccount.addEventListener("click", () => {
      hideAllSections();
      sectionAccount.classList.remove("hidden");
      setActiveNav(navAccount);
      checkUserLoggedIn();
    });

    // Initialize to Top Up section on page load
    window.addEventListener("load", () => {
      hideAllSections();
      sectionTopUp.classList.remove("hidden");
      setActiveNav(navTopUp);
      resetTopUp();
      populateGames();
      populatePriceTable();
    });

    // Populate games dynamically
    const gamesList = [
      {
        name: "Mobile Legends",
        publisher: "Moonton",
        img: "https://storage.googleapis.com/a1aa/image/7b411ccc-da85-4cbb-03e6-4d757b787869.jpg",
      },
      {
        name: "Free Fire",
        publisher: "Garena",
        img: "https://storage.googleapis.com/a1aa/image/b5cb32e3-f59d-4494-9eab-1c50abe024fe.jpg",
      },
      {
        name: "PUBG Mobile",
        publisher: "Tencent",
        img: "https://storage.googleapis.com/a1aa/image/98ca53a8-ecb8-4d69-d94f-b5f001b45a1c.jpg",
      },
      {
        name: "Point Blank",
        publisher: "Zepetto",
        img: "https://storage.googleapis.com/a1aa/image/a009a010-25f1-4d38-271b-b8baaecb065f.jpg",
      },
      {
        name: "Clans of Clan",
        publisher: "Supercell",
        img: "https://storage.googleapis.com/a1aa/image/f298b43c-7819-4b17-75e0-25140034db41.jpg",
      },
      {
        name: "Genshin Impact",
        publisher: "miHoYo",
        img: "https://storage.googleapis.com/a1aa/image/1032d6d0-94eb-4a68-e4df-862062f2bc56.jpg",
      },
      {
        name: "Call Of Duty",
        publisher: "Garena",
        img: "https://storage.googleapis.com/a1aa/image/8265a28a-07d5-44c1-95a4-a48c971242fa.jpg",
      },
      {
        name: "League Of Legends",
        publisher: "Riot",
        img: "https://storage.googleapis.com/a1aa/image/82c1eeb0-4872-43b4-377f-a5342d9e7e59.jpg",
      },
      {
        name: "Among Us",
        publisher: "Innersloth",
        img: "https://storage.googleapis.com/a1aa/image/2fa8b024-f6f2-4b78-770d-b0a58008dd98.jpg",
      },
      {
        name: "Minecraft",
        publisher: "Mojang",
        img: "https://storage.googleapis.com/a1aa/image/11cf13a5-391a-4687-76fe-6f4c0a38bd98.jpg",
      },
      {
        name: "Roblox",
        publisher: "Roblox Corporation",
        img: "https://storage.googleapis.com/a1aa/image/fec7daf9-ac36-4b36-2890-f8943ee2636e.jpg",
      },
      {
        name: "Valorant",
        publisher: "Riot",
        img: "https://storage.googleapis.com/a1aa/image/d8fa6e52-49d1-4edf-2f08-9249369eba8b.jpg",
      },
      {
        name: "Fortnite",
        publisher: "Epic Games",
        img: "https://storage.googleapis.com/a1aa/image/fc120ceb-cf6d-4c38-6388-a6078b7515ee.jpg",
      },
    ];

    function populateGames() {
      const gamesGrid = document.getElementById("gamesGrid");
      gamesGrid.innerHTML = "";
      gamesList.forEach((game) => {
        const div = document.createElement("div");
        div.className =
          "bg-gray-900 rounded-md p-4 flex flex-col items-center space-y-2 game-card cursor-pointer";
        div.setAttribute("data-name", game.name);
        div.onclick = () => selectGame(game.name);
        div.innerHTML = `
          <img alt="${game.name} game icon" class="w-20 h-20 rounded-lg" src="${game.img}" width="80" height="80" />
          <span class="text-gray-500 text-xs">${game.publisher}</span>
          <span class="text-white font-semibold text-sm text-center">${game.name}</span>
        `;
        gamesGrid.appendChild(div);
      });
    }

    // Packages data (same as before)
    const packagesData = {
      "Mobile Legends": [
        { id: 1, name: "50 Diamonds", price: 8000 },
        { id: 2, name: "100 Diamonds", price: 15000 },
        { id: 3, name: "250 Diamonds", price: 35000 },
        { id: 4, name: "500 Diamonds", price: 65000 },
      ],
      "Free Fire": [
        { id: 1, name: "140 Diamonds", price: 20000 },
        { id: 2, name: "355 Diamonds", price: 50000 },
        { id: 3, name: "720 Diamonds", price: 100000 },
      ],
      "PUBG Mobile": [
        { id: 1, name: "UC 60", price: 12000 },
        { id: 2, name: "UC 300", price: 50000 },
        { id: 3, name: "UC 600", price: 95000 },
      ],
      "Point Blank": [
        { id: 1, name: "Cash 100", price: 10000 },
        { id: 2, name: "Cash 500", price: 45000 },
        { id: 3, name: "Cash 1000", price: 85000 },
      ],
      "Clans of Clan": [
        { id: 1, name: "Gold 1000", price: 15000 },
        { id: 2, name: "Gold 5000", price: 70000 },
        { id: 3, name: "Gold 10000", price: 130000 },
      ],
      "Genshin Impact": [
        { id: 1, name: "60 Primogems", price: 10000 },
        { id: 2, name: "300 Primogems", price: 45000 },
        { id: 3, name: "980 Primogems", price: 140000 },
      ],
      "Call Of Duty": [
        { id: 1, name: "CP 500", price: 75000 },
        { id: 2, name: "CP 1000", price: 140000 },
        { id: 3, name: "CP 2000", price: 270000 },
      ],
      "League Of Legends": [
        { id: 1, name: "RP 650", price: 100000 },
        { id: 2, name: "RP 1380", price: 200000 },
        { id: 3, name: "RP 2800", price: 400000 },
      ],
      "Among Us": [
        { id: 1, name: "Crewmate Pack", price: 15000 },
        { id: 2, name: "Impostor Pack", price: 25000 },
      ],
      "Minecraft": [
        { id: 1, name: "Minecraft Java Edition", price: 300000 },
        { id: 2, name: "Minecraft Bedrock Edition", price: 350000 },
      ],
      "Roblox": [
        { id: 1, name: "Robux 400", price: 60000 },
        { id: 2, name: "Robux 800", price: 110000 },
      ],
      "Valorant": [
        { id: 1, name: "VP 875", price: 150000 },
        { id: 2, name: "VP 1750", price: 300000 },
      ],
      "Fortnite": [
        { id: 1, name: "1000 V-Bucks", price: 150000 },
        { id: 2, name: "2800 V-Bucks", price: 400000 },
      ],
    };

    let selectedGame = null;
    let selectedPackage = null;
    let selectedPaymentMethod = null;

    function selectGame(gameName) {
      selectedGame = gameName;
      selectedPackage = null;
      selectedPaymentMethod = null;
      document.getElementById("selectedGameTitle").textContent = `Pilih Paket Top Up - ${gameName}`;
      const packagesGrid = document.getElementById("packagesGrid");
      packagesGrid.innerHTML = "";
      if (!packagesData[gameName]) {
        packagesGrid.innerHTML = '<p class="text-gray-400">Paket belum tersedia untuk game ini.</p>';
        return;
      }
      packagesData[gameName].forEach((pkg) => {
        const pkgDiv = document.createElement("div");
        pkgDiv.className =
          "bg-gray-800 rounded-md p-4 cursor-pointer hover:bg-blue-600 transition-colors flex flex-col items-center";
        pkgDiv.innerHTML = `
          <span class="text-white font-semibold">${pkg.name}</span>
          <span class="text-blue-400 font-bold mt-1">Rp ${pkg.price.toLocaleString(
            "id-ID"
          )}</span>
        `;
        pkgDiv.onclick = () => {
          document.querySelectorAll("#packagesGrid > div").forEach((d) =>
            d.classList.remove("bg-blue-700")
          );
          pkgDiv.classList.add("bg-blue-700");
          selectedPackage = pkg;
        };
        packagesGrid.appendChild(pkgDiv);
      });
      document.getElementById("packageSection").classList.remove("hidden");
      document.getElementById("paymentMethodsSection").classList.add("hidden");
      document.getElementById("paymentSection").classList.add("hidden");
      window.scrollTo({
        top: document.getElementById("packageSection").offsetTop - 20,
        behavior: "smooth",
      });
    }

    function showPaymentMethods() {
      if (!selectedPackage) {
        alert("Silakan pilih paket top up terlebih dahulu.");
        return;
      }
      document.getElementById("packageSection").classList.add("hidden");
      document.getElementById("paymentMethodsSection").classList.remove("hidden");
      document.getElementById("paymentSection").classList.add("hidden");
      window.scrollTo({
        top: document.getElementById("paymentMethodsSection").offsetTop - 20,
        behavior: "smooth",
      });
    }

    function contactAdmin(method) {
      selectedPaymentMethod = method;
      const waNumber = "6285270892831";
      const user = getCurrentUser();
      const userName = user ? user.email : "Pengguna";
      const message = encodeURIComponent(
        `Halo Admin Top Up Frenzy, saya ingin melakukan Top Up:\n` +
          `Nama: ${userName}\n` +
          `Game: ${selectedGame}\n` +
          `Paket: ${selectedPackage ? selectedPackage.name : "-"}\n` +
          `Metode Pembayaran: ${method}\n` +
          `Mohon info pembayaran dan proses selanjutnya.`
      );
      const waUrl = `https://wa.me/${waNumber}?text=${message}`;
      window.open(waUrl, "_blank");
      // Show payment instructions section
      document.getElementById("paymentMethodsSection").classList.add("hidden");
      document.getElementById("paymentSection").classList.remove("hidden");
      document.getElementById(
        "paymentMethodInfo"
      ).textContent = `Anda memilih metode pembayaran: ${method}. Silakan lakukan pembayaran melalui WhatsApp Admin dan kirimkan bukti pembayaran serta detail top up Anda.`;
      window.scrollTo({
        top: document.getElementById("paymentSection").offsetTop - 20,
        behavior: "smooth",
      });
    }

    function backToPackages() {
      document.getElementById("paymentMethodsSection").classList.add("hidden");
      document.getElementById("packageSection").classList.remove("hidden");
      document.getElementById("paymentSection").classList.add("hidden");
      window.scrollTo({
        top: document.getElementById("packageSection").offsetTop - 20,
        behavior: "smooth",
      });
    }

    function resetTopUp() {
      selectedGame = null;
      selectedPackage = null;
      selectedPaymentMethod = null;
      document.getElementById("packageSection").classList.add("hidden");
      document.getElementById("paymentMethodsSection").classList.add("hidden");
      document.getElementById("paymentSection").classList.add("hidden");
      document.querySelectorAll("#gamesGrid > div").forEach((div) =>
        div.classList.remove("bg-blue-700")
      );
    }

    // Populate price table dynamically
    function populatePriceTable() {
      const tbody = document.getElementById("priceTableBody");
      tbody.innerHTML = "";
      for (const [game, packages] of Object.entries(packagesData)) {
        packages.forEach((pkg) => {
          const tr = document.createElement("tr");
          tr.className = "border-b border-gray-700";
          tr.innerHTML = `
            <td class="py-2 px-3">${game}</td>
            <td class="py-2 px-3">${pkg.name}</td>
            <td class="py-2 px-3">Rp ${pkg.price.toLocaleString("id-ID")}</td>
          `;
          tbody.appendChild(tr);
        });
      }
    }

    // Account login and registration logic (simple localStorage simulation)
    function showRegister() {
      document.getElementById("loginForm").classList.add("hidden");
      document.getElementById("registerForm").classList.remove("hidden");
      document.getElementById("registerSuccess").classList.add("hidden");
    }

    function registerUser(event) {
      event.preventDefault();
      const email = document.getElementById("registerEmail").value.trim();
      const password = document.getElementById("registerPassword").value.trim();

      if (!email || !password) {
        alert("Email dan password harus diisi.");
        return false;
      }

      const emailRegex = /^[^\s@]+@[^\s@]+\.[^\s@]+$/;
      if (!emailRegex.test(email)) {
        alert("Format email tidak valid.");
        return false;
      }

      let users = JSON.parse(localStorage.getItem("users") || "[]");
      if (users.find((u) => u.email === email)) {
        alert("Email sudah terdaftar.");
        return false;
      }

      users.push({ email, password });
      localStorage.setItem("users", JSON.stringify(users));

      document.getElementById("registerForm").reset();
      document.getElementById("registerSuccess").classList.remove("hidden");

      alert("Pendaftaran berhasil! Silakan login menggunakan email dan password Anda.");
      showLogin();

      return false;
    }

    function loginUser(event) {
      event.preventDefault();
      const email = document.getElementById("loginEmail").value.trim();
      const password = document.getElementById("loginPassword").value.trim();

      if (!email || !password) {
        alert("Email dan password harus diisi.");
        return false;
      }

      let users = JSON.parse(localStorage.getItem("users") || "[]");
      const user = users.find((u) => u.email === email && u.password === password);
      if (!user) {
        alert("Email atau password salah.");
        return false;
      }

      localStorage.setItem("currentUser", JSON.stringify(user));
      alert(`Selamat datang, ${email}! Anda berhasil login.`);
      showUserInfo();
      return false;
    }

    function logoutUser() {
      localStorage.removeItem("currentUser");
      alert("Anda telah logout.");
      showLogin();
    }

    function getCurrentUser() {
      return JSON.parse(localStorage.getItem("currentUser"));
    }

    function showUserInfo() {
      const user = getCurrentUser();
      if (!user) {
        showLogin();
        return;
      }
      document.getElementById("userInfo").classList.remove("hidden");
      document.getElementById("loginForm").classList.add("hidden");
      document.getElementById("registerForm").classList.add("hidden");
      document.getElementById("registerSuccess").classList.add("hidden");

      // Show user email and avatar
      document.getElementById("userName").textContent = user.email;
      // Generate avatar URL using Gravatar
      const emailHash = md5(user.email.trim().toLowerCase());
      const gravatarUrl = `https://www.gravatar.com/avatar/${emailHash}?d=identicon&s=64`;
      document.getElementById("userAvatar").src = gravatarUrl;
    }

    function showLogin() {
      document.getElementById("userInfo").classList.add("hidden");
      document.getElementById("loginForm").classList.remove("hidden");
      document.getElementById("registerForm").classList.add("hidden");
      document.getElementById("registerSuccess").classList.add("hidden");
    }

    function checkUserLoggedIn() {
      const user = getCurrentUser();
      if (user) {
        showUserInfo();
      } else {
        showLogin();
      }
    }

    // MD5 function for gravatar hash (simple implementation)
    // Source: https://stackoverflow.com/a/16552188
    function md5(string) {
      function RotateLeft(lValue, iShiftBits) {
        return (lValue << iShiftBits) | (lValue >>> (32 - iShiftBits));
      }
      function AddUnsigned(lX, lY) {
        let lX4, lY4, lX8, lY8, lResult;
        lX8 = lX & 0x80000000;
        lY8 = lY & 0x80000000;
        lX4 = lX & 0x40000000;
        lY4 = lY & 0x40000000;
        lResult = (lX & 0x3fffffff) + (lY & 0x3fffffff);
        if (lX4 & lY4) {
          return lResult ^ 0x80000000 ^ lX8 ^ lY8;
        }
        if (lX4 | lY4) {
          if (lResult & 0x40000000) {
            return lResult ^ 0xc0000000 ^ lX8 ^ lY8;
          } else {
            return lResult ^ 0x40000000 ^ lX8 ^ lY8;
          }
        } else {
          return lResult ^ lX8 ^ lY8;
        }
      }
      function F(x, y, z) {
        return (x & y) | (~x & z);
      }
      function G(x, y, z) {
        return (x & z) | (y & ~z);
      }
      function H(x, y, z) {
        return x ^ y ^ z;
      }
      function I(x, y, z) {
        return y ^ (x | ~z);
      }
      function FF(a, b, c, d, x, s, ac) {
        a = AddUnsigned(a, AddUnsigned(AddUnsigned(F(b, c, d), x), ac));
        return AddUnsigned(RotateLeft(a, s), b);
      }
      function GG(a, b, c, d, x, s, ac) {
        a = AddUnsigned(a, AddUnsigned(AddUnsigned(G(b, c, d), x), ac));
        return AddUnsigned(RotateLeft(a, s), b);
      }
      function HH(a, b, c, d, x, s, ac) {
        a = AddUnsigned(a, AddUnsigned(AddUnsigned(H(b, c, d), x), ac));
        return AddUnsigned(RotateLeft(a, s), b);
      }
      function II(a, b, c, d, x, s, ac) {
        a = AddUnsigned(a, AddUnsigned(AddUnsigned(I(b, c, d), x), ac));
        return AddUnsigned(RotateLeft(a, s), b);
      }
      function ConvertToWordArray(string) {
        let lWordCount;
        const lMessageLength = string.length;
        const lNumberOfWords_temp1 = lMessageLength + 8;
        const lNumberOfWords_temp2 =
          (lNumberOfWords_temp1 - (lNumberOfWords_temp1 % 64)) / 64;
        const lNumberOfWords = (lNumberOfWords_temp2 + 1) * 16;
        const lWordArray = new Array(lNumberOfWords - 1);
        let lBytePosition = 0;
        let lByteCount = 0;
        while (lByteCount < lMessageLength) {
          lWordCount = (lByteCount - (lByteCount % 4)) / 4;
          lBytePosition = (lByteCount % 4) * 8;
          lWordArray[lWordCount] =
            (lWordArray[lWordCount] | (string.charCodeAt(lByteCount) << lBytePosition)) >>>
            0;
          lByteCount++;
        }
        lWordCount = (lByteCount - (lByteCount % 4)) / 4;
        lBytePosition = (lByteCount % 4) * 8;
        lWordArray[lWordCount] =
          lWordArray[lWordCount] | (0x80 << lBytePosition);
        lWordArray[lNumberOfWords - 2] = (lMessageLength << 3) >>> 0;
        lWordArray[lNumberOfWords - 1] = (lMessageLength >>> 29) >>> 0;
        return lWordArray;
      }
      function WordToHex(lValue) {
        let WordToHexValue = "",
          WordToHexValue_temp = "",
          lByte,
          lCount;
        for (lCount = 0; lCount <= 3; lCount++) {
          lByte = (lValue >>> (lCount * 8)) & 255;
          WordToHexValue_temp = "0" + lByte.toString(16);
          WordToHexValue += WordToHexValue_temp.substr(
            WordToHexValue_temp.length - 2,
            2
          );
        }
        return WordToHexValue;
      }
      function Utf8Encode(string) {
        string = string.replace(/\r\n/g, "\n");
        let utftext = "";
        for (let n = 0; n < string.length; n++) {
          const c = string.charCodeAt(n);
          if (c < 128) {
            utftext += String.fromCharCode(c);
          } else if (c > 127 && c < 2048) {
            utftext += String.fromCharCode((c >> 6) | 192);
            utftext += String.fromCharCode((c & 63) | 128);
          } else {
            utftext += String.fromCharCode((c >> 12) | 224);
            utftext += String.fromCharCode(((c >> 6) & 63) | 128);
            utftext += String.fromCharCode((c & 63) | 128);
          }
        }
        return utftext;
      }
      let x = [];
      let k, AA, BB, CC, DD, a, b, c, d;
      const S11 = 7,
        S12 = 12,
        S13 = 17,
        S14 = 22;
      const S21 = 5,
        S22 = 9,
        S23 = 14,
        S24 = 20;
      const S31 = 4,
        S32 = 11,
        S33 = 16,
        S34 = 23;
      const S41 = 6,
        S42 = 10,
        S43 = 15,
        S44 = 21;
      string = Utf8Encode(string);
      x = ConvertToWordArray(string);
      a = 0x67452301;
      b = 0xefcdab89;
      c = 0x98badcfe;
      d = 0x10325476;
      for (k = 0; k < x.length; k += 16) {
        AA = a;
        BB = b;
        CC = c;
        DD = d;
        a = FF(a, b, c, d, x[k + 0], S11, 0xd76aa478);
        d = FF(d, a, b, c, x[k + 1], S12, 0xe8c7b756);
        c = FF(c, d, a, b, x[k + 2], S13, 0x242070db);
        b = FF(b, c, d, a, x[k + 3], S14, 0xc1bdceee);
        a = FF(a, b, c, d, x[k + 4], S11, 0xf57c0faf);
        d = FF(d, a, b, c, x[k + 5], S12, 0x4787c62a);
        c = FF(c, d, a, b, x[k + 6], S13, 0xa8304613);
        b = FF(b, c, d, a, x[k + 7], S14, 0xfd469501);
        a = FF(a, b, c, d, x[k + 8], S11, 0x698098d8);
        d = FF(d, a, b, c, x[k + 9], S12, 0x8b44f7af);
        c = FF(c, d, a, b, x[k + 10], S13, 0xffff5bb1);
        b = FF(b, c, d, a, x[k + 11], S14, 0x895cd7be);
        a = FF(a, b, c, d, x[k + 12], S11, 0x6b901122);
        d = FF(d, a, b, c, x[k + 13], S12, 0xfd987193);
        c = FF(c, d, a, b, x[k + 14], S13, 0xa679438e);
        b = FF(b, c, d, a, x[k + 15], S14, 0x49b40821);
        a = GG(a, b, c, d, x[k + 1], S21, 0xf61e2562);
        d = GG(d, a, b, c, x[k + 6], S22, 0xc040b340);
        c = GG(c, d, a, b, x[k + 11], S23, 0x265e5a51);
        b = GG(b, c, d, a, x[k + 0], S24, 0xe9b6c7aa);
        a = GG(a, b, c, d, x[k + 5], S21, 0xd62f105d);
        d = GG(d, a, b, c, x[k + 10], S22, 0x2441453);
        c = GG(c, d, a, b, x[k + 15], S23, 0xd8a1e681);
        b = GG(b, c, d, a, x[k + 4], S24, 0xe7d3fbc8);
        a = GG(a, b, c, d, x[k + 9], S21, 0x21e1cde6);
        d = GG(d, a, b, c, x[k + 14], S22, 0xc33707d6);
        c = GG(c, d, a, b, x[k + 3], S23, 0xf4d50d87);
        b = GG(b, c, d, a, x[k + 8], S24, 0x455a14ed);
        a = GG(a, b, c, d, x[k + 13], S21, 0xa9e3e905);
        d = GG(d, a, b, c, x[k + 2], S22, 0xfcefa3f8);
        c = GG(c, d, a, b, x[k + 7], S23, 0x676f02d9);
        b = GG(b, c, d, a, x[k + 12], S24, 0x8d2a4c8a);
        a = HH(a, b, c, d, x[k + 5], S31, 0xfffa3942);
        d = HH(d, a, b, c, x[k + 8], S32, 0x8771f681);
        c = HH(c, d, a, b, x[k + 11], S33, 0x6d9d6122);
        b = HH(b, c, d, a, x[k + 14], S34, 0xfde5380c);
        a = HH(a, b, c, d, x[k + 1], S31, 0xa4beea44);
        d = HH(d, a, b, c, x[k + 4], S32, 0x4bdecfa9);
        c = HH(c, d, a, b, x[k + 7], S33, 0xf6bb4b60);
        b = HH(b, c, d, a, x[k + 10], S34, 0xbebfbc70);
        a = HH(a, b, c, d, x[k + 13], S31, 0x289b7ec6);
        d = HH(d, a, b, c, x[k + 0], S32, 0xeaa127fa);
        c = HH(c, d, a, b, x[k + 3], S33, 0xd4ef3085);
        b = HH(b, c, d, a, x[k + 6], S34, 0x488105);
        a = HH(a, b, c, d, x[k + 9], S31, 0xd9d4d039);
        d = HH(d, a, b, c, x[k + 12], S32, 0xe6db99e5);
        c = HH(c, d, a, b, x[k + 15], S33, 0x1fa27cf8);
        b = HH(b, c, d, a, x[k + 2], S34, 0xc4ac5665);
        a = II(a, b, c, d, x[k + 0], S41, 0xf4292244);
        d = II(d, a, b, c, x[k + 7], S42, 0x432aff97);
        c = II(c, d, a, b, x[k + 14], S43, 0xab9423a7);
        b = II(b, c, d, a, x[k + 5], S44, 0xfc93a039);
        a = II(a, b, c, d, x[k + 12], S41, 0x655b59c3);
        d = II(d, a, b, c, x[k + 3], S42, 0x8f0ccc92);
        c = II(c, d, a, b, x[k + 10], S43, 0xffeff47d);
        b = II(b, c, d, a, x[k + 1], S44, 0x85845dd1);
        a = II(a, b, c, d, x[k + 8], S41, 0x6fa87e4f);
        d = II(d, a, b, c, x[k + 15], S42, 0xfe2ce6e0);
        c = II(c, d, a, b, x[k + 6], S43, 0xa3014314);
        b = II(b, c, d, a, x[k + 13], S44, 0x4e0811a1);
        a = II(a, b, c, d, x[k + 4], S41, 0xf7537e82);
        d = II(d, a, b, c, x[k + 11], S42, 0xbd3af235);
        c = II(c, d, a, b, x[k + 2], S43, 0x2ad7d2bb);
        b = II(b, c, d, a, x[k + 9], S44, 0xeb86d391);
        a = AddUnsigned(a, AA);
        b = AddUnsigned(b, BB);
        c = AddUnsigned(c, CC);
        d = AddUnsigned(d, DD);
      }
      const temp =
        WordToHex(a) + WordToHex(b) + WordToHex(c) + WordToHex(d);
      return temp.toLowerCase();
    }
  </script>
</body>
</html>